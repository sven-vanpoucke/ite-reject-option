CHAPTER 1: INTRODUCTION
# This section introduces the purpose and background of the analysis.

In this analysis, we aim to evaluate the performance of different reject options for Information Treatment Effect (ITE) models.The ITE model predicts the individual treatment effects in a given dataset, providing valuable insights into the impact of interventions.
For your information, this file has been automatically generated on: 2024-02-27 17:39
\Chapter 2: Preprocessing

# This section executes the data retrieval, preprocessing and splitting in a training and dataset.During the whole file, the used dataset is: IHDP

CHAPTER 3: Training of the ITE Model

# This section provides details about the model selection, training process, and any hyperparameter tuning.
The trained ITE model is a T-LEARNER.
The two individually trained models are: LinearRegression


CHAPTER 7: REJECTION 

# This section executes and reports metrics for ITE models with rejection.


Table of all_data (First 5 rows)
+-----------+--------------------+--------------------+--------------------+--------------------+------------------+--------------------+-------------------+--------------------+--------------------+-----+----------+
| treatment |     y_t1_pred      |     y_t0_pred      |      ite_pred      |        y_t0        |       y_t1       |        ite         |    size_of_ci     |     ite_reject     |         se         | ood | y_reject |
+-----------+--------------------+--------------------+--------------------+--------------------+------------------+--------------------+-------------------+--------------------+--------------------+-----+----------+
|     0     | 5.046845507919879  | 4.121227369959079  | 0.9256181379608002 | -0.260075906393018 | 7.99568586346053 | 8.255761769853548  | 6.388233989030741 | 0.9256181379608002 |  53.7310056641778  |  1  |  False   |
|     0     | 6.644990366550511  | 2.988167742468608  | 3.6568226240819026 |  1.92866089287586  | 4.58037594329943 | 2.6517150504235696 | 6.384021698017188 | 3.6568226240819026 | 1.0102412346253413 |  1  |  False   |
|     0     | 6.824252184396492  | 2.766865847142988  | 4.057386337253504  |  1.20050522136526  | 4.12490993427065 |  2.92440471290539  |  6.1084284294081  | 4.057386337253504  | 1.2836473611104922 |  1  |  False   |
|     1     | 7.3969091912448945 | 3.841015344359022  | 3.5558938468858727 |  3.51731892272842  | 5.38790122007399 | 1.8705822973455706 | 5.980737210792231 | 3.5558938468858727 | 2.8402750190139345 |  1  |  False   |
|     0     | 6.531566029622995  | 1.4679814947164758 |  5.06358453490652  |  4.19726391306783  | 7.50961391999809 | 3.3123500069302603 |  5.782299228003   |  5.06358453490652  | 3.0668223719762318 |  1  |  False   |
+-----------+--------------------+--------------------+--------------------+--------------------+------------------+--------------------+-------------------+--------------------+--------------------+-----+----------+
# Experiment 0: No Rejector - Baseline Model
# Experiment 1: Perfect Rejection
# Experiment 2: Rejection based on IsolationForest - novelty of instance to all data
# Experiment 3: Rejection based on OCSVM - novelty of instance to all data
# Experiment 4: Rejection based on LocalOutlierFactor - novelty of instance to all data
# Experiment 5: Rejection based on IsolationForest - novelty of T (UT) instance to UT (T) instance
# Experiment 6: Rejection based on OSCVM - novelty of T (UT) instance to UT (T) instance
# Experiment 7: Rejection based on LocalOutlierFactor - novelty of T (UT) instance to UT (T) instance
# Experiment 8: Rejection based on IsolationForest - novelty of T (UT) instance to UT (T) instance
# Experiment 9: Rejection based on OSCVM - novelty of T (UT) instance to UT (T) instance
# Experiment 10: Rejection based on LocalOutlierFactor - novelty of T (UT) instance to UT (T) instance
# Experiment 11: Rejection based bootstrapping (confidence interval)

Table of results of the experiments
╭────────────────────┬──────────┬──────────┬────────┬────────┬────────┬─────────┬────────┬────────┬─────────┬─────────┬─────────┬────────╮
│                    │        0 │        1 │      2 │      3 │      4 │       5 │      6 │      7 │       8 │       9 │      10 │     11 │
├────────────────────┼──────────┼──────────┼────────┼────────┼────────┼─────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ Rejection Rate     │   0      │   0.2396 │ 0.241  │ 0.2383 │ 0.2262 │  0.2396 │ 0.2396 │ 0.2396 │  0.2396 │  0.2396 │  0.2396 │ 0.0107 │
├────────────────────┼──────────┼──────────┼────────┼────────┼────────┼─────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ Original RMSE      │   1.4916 │   1.4916 │ 1.4916 │ 1.4916 │ 1.4916 │  1.4916 │ 1.4916 │ 1.4916 │  1.4916 │  1.4916 │  1.4916 │ 1.8704 │
├────────────────────┼──────────┼──────────┼────────┼────────┼────────┼─────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ RMSE               │   1.4916 │   0.9213 │ 1.5067 │ 1.5133 │ 1.4946 │  1.476  │ 1.4955 │ 1.5181 │  1.4302 │  1.4495 │  1.4736 │ 1.8727 │
├────────────────────┼──────────┼──────────┼────────┼────────┼────────┼─────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ Change of RMSE (%) │   0      │ -38.2377 │ 1.012  │ 1.4509 │ 0.2004 │ -1.0481 │ 0.2604 │ 1.7722 │ -4.1198 │ -2.8261 │ -1.2095 │ 0.1276 │
├────────────────────┼──────────┼──────────┼────────┼────────┼────────┼─────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ RMSE Rejected      │ nan      │   2.5675 │ 1.443  │ 1.4202 │ 1.4814 │  1.5402 │ 1.4792 │ 1.4044 │  1.6717 │  1.6181 │  1.5475 │ 1.6565 │
├────────────────────┼──────────┼──────────┼────────┼────────┼────────┼─────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ Accuracy           │   0      │   0      │ 0      │ 0      │ 0      │  0      │ 0      │ 0      │  0      │  0      │  0      │ 0      │
╰────────────────────┴──────────┴──────────┴────────┴────────┴────────┴─────────┴────────┴────────┴─────────┴─────────┴─────────┴────────╯