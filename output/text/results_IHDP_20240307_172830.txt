CHAPTER 1: INTRODUCTION
# This section introduces the purpose and background of the analysis.

In this analysis, we aim to evaluate the performance of different reject options for Information Treatment Effect (ITE) models.The ITE model predicts the individual treatment effects in a given dataset, providing valuable insights into the impact of interventions.
For your information, this file has been automatically generated on: 2024-03-07 17:28
\Chapter 2: Preprocessing

# This section executes the data retrieval, preprocessing and splitting in a training and dataset.During the whole file, the used dataset is: IHDP


CHAPTER 7: REJECTION 

# This section executes and reports metrics for ITE models with rejection.


Table of all_data (First 5 rows)
+-----------+-------------------+--------------------+--------------------+--------------------+------------------+---------------------+--------------------+--------------------+---------------------+-------+-----------+-----------------------+-------------------+-----+----------+--------------------------+------------------------------+
| treatment |     y_t1_pred     |     y_t0_pred      |      ite_pred      |        y_t0        |       y_t1       |         ite         |     ite_reject     |         se         | Sign Error Original | rank  | rank_pred |      rank_weight      |      se_rank      | ood | y_reject | amount_of_times_rejected | amount_of_times_rejected_new |
+-----------+-------------------+--------------------+--------------------+--------------------+------------------+---------------------+--------------------+--------------------+---------------------+-------+-----------+-----------------------+-------------------+-----+----------+--------------------------+------------------------------+
|    nan    | 7.193863714802825 | 3.145412683434496  | 4.048451031368329  |  5.27630515157302  | 4.29383626530163 | -0.9824688862713895 | 4.048451031368329  | 25.310155217704036 |         1.0         |  4.0  |   369.0   |         0.25          |     33306.25      |  1  |  False   |            0             |              0               |
|    0.0    | 4.924233534995176 | 2.5385879271199463 |  2.38564560787523  |  0.37146047771323  | 7.77452599653371 |  7.403065518820481  |  2.38564560787523  | 25.174502562749844 |         0.0         | 738.0 |   20.0    | 0.0013550135501355014 | 698.5420054200542 |  1  |  False   |            0             |              0               |
|    nan    | 5.309711124614462 | 1.715798218753361  | 3.5939129058611012 | -0.568745297078949 | 7.94687677112342 |  8.515622068202369  | 3.5939129058611012 | 24.22322107867398  |         0.0         | 747.0 |   193.0   | 0.0013386880856760374 | 410.8647925033467 |  1  |  False   |            0             |              0               |
|    nan    | 4.522012224992153 | 2.7281500401868897 | 1.7938621848052634 |  1.50519829739236  | 7.72702960004262 |  6.22183130265026   | 1.7938621848052634 |  19.606910508589   |         0.0         | 695.0 |    7.0    | 0.0014388489208633094 | 681.0705035971223 |  1  |  False   |            0             |              0               |
|    0.0    | 6.894930888844074 | 4.1417150221382295 | 2.753215866705845  |  2.72920854936937  | 9.49449669072071 |  6.765288141351341  | 2.753215866705845  | 16.09672393697909  |         0.0         | 720.0 |   37.0    | 0.001388888888888889  | 647.901388888889  |  1  |  False   |            0             |              0               |
+-----------+-------------------+--------------------+--------------------+--------------------+------------------+---------------------+--------------------+--------------------+---------------------+-------+-----------+-----------------------+-------------------+-----+----------+--------------------------+------------------------------+
# Experiment 0: No Rejector - Baseline Model
# Experiment 1: Perfect Rejection
# Experiment 2: Rejection based on IsolationForest (train data) - Novelty Type I
# Experiment 3: Rejection based on OneClassSVM (train data) - Novelty Type I
# Experiment 4: Rejection based on LocalOutlierFactor (train data) - Novelty Type I
# Experiment 5: Rejection based on IsolationForest (train data) - Novelty Type II
# Experiment 6: Rejection based on OneClassSVM (train data) - Novelty Type II
# Experiment 7: Rejection based on LocalOutlierFactor (train data) - Novelty Type II
# Experiment 8: Rejection based on IsolationForest (train data) - Novelty Type III
# Experiment 9: Rejection based on OneClassSVM (train data) - Novelty Type III
# Experiment 10: Rejection based on LocalOutlierFactor (train data) - Novelty Type III
# Experiment 11: Rejection based on RandomForestQuantileRegressor - Ambiguity Type I

Table of results of the experiments
╭─────────────────────────────────────┬──────────┬───────────┬────────────┬───────────┬────────────┬───────────┬───────────┬─────────────┬───────────┬───────────┬──────────┬───────────╮
│                                     │        0 │         1 │          2 │         3 │          4 │         5 │         6 │           7 │         8 │         9 │       10 │        11 │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ Rejection Rate                      │   0      │    0.3896 │   0.34     │   0.3869  │   0.0094   │   0.0897  │   0.0696  │   0.0495    │   0.0897  │   0.0696  │   0.0495 │   0.3695  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ RMSE Original                       │   1.4916 │    1.4916 │   1.4916   │   1.4916  │   1.4916   │   1.4916  │   1.4916  │   1.4916    │   1.4916  │   1.4916  │   1.4916 │   1.4916  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ RMSE Accepted                       │   1.4916 │    0.6882 │   1.4789   │   1.481   │   1.4882   │   1.3718  │   1.4005  │   1.4074    │   1.3925  │   1.4076  │   1.4384 │   1.2857  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ RMSE Change (%)                     │   0      │  -53.859  │  -0.8517   │  -0.7123  │  -0.2316   │  -8.0338  │  -6.1074  │  -5.6478    │  -6.6426  │  -5.6324  │  -3.5708 │ -13.8083  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ RMSE Rejected                       │ nan      │    2.2292 │   1.516    │   1.5083  │   1.8202   │   2.389   │   2.3971  │   2.6289    │   2.2639  │   2.341   │   2.2846 │   1.7892  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤

│ Sign Error Original (%)             │   1.6064 │    1.6064 │   1.6064   │   1.6064  │   1.6064   │   1.6064  │   1.6064  │   1.6064    │   1.6064  │   1.6064  │   1.6064 │   1.6064  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ Sign Error Accepted (%)             │   1.6064 │    0      │   1.0142   │   1.31    │   1.6216   │   1.1765  │   1.295   │   1.5493    │   1.3235  │   1.295   │   1.6901 │   0.6369  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ Sign Error Change (%)               │   0      │ -100      │ -36.8661   │ -18.4498  │   0.9459   │ -26.7647  │ -19.3885  │  -3.5563    │ -17.6103  │ -19.3885  │   5.2113 │ -60.3503  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ Sign Error Rejected (%)             │ nan      │    4.1237 │   2.7559   │   2.0761  │   0        │   5.9701  │   5.7692  │   2.7027    │   4.4776  │   5.7692  │   0      │   3.2609  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤

│ RMSE Rank Original                  │ 256.298  │  256.298  │ 256.298    │ 256.298   │ 256.298    │ 256.298   │ 256.298   │ 256.298     │ 256.298   │ 256.298   │ 256.298  │ 256.298   │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ RMSE Rank Accepted                  │ 256.298  │  111.608  │ 173.295    │ 158.028   │ 253.257    │ 226.339   │ 230.308   │ 236.293     │ 226.877   │ 230.791   │ 237.716  │ 166.93    │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ RMSE Rank Change (%)                │   0      │  -56.1676 │  -6.8046   │ -15.3326  │  -0.629    │  -5.1665  │  -3.2923  │  -7.8451    │  -1.6537  │  -3.232   │  -2.9711 │ -17.9523  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ RMSE Rank Rejected                  │ nan      │  105.43   │  83.1777   │  98.5002  │   3.1623   │  23.5252  │  18.9828  │  14.7465    │  22.964   │  18.461   │  14.0962 │  89.1817  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤

│ RMSE Rank Weighted Original         │  20.132  │   20.132  │  20.132    │  20.132   │  20.132    │  20.132   │  20.132   │  20.132     │  20.132   │  20.132   │  20.132  │  20.132   │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ RMSE Rank Weighted Accepted         │  20.132  │    8.8243 │  18.7621   │  17.0453  │  20.0054   │  19.0919  │  19.4692  │  18.5527    │  19.7991  │  19.4814  │  19.5339 │  16.5179  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ RMSE Rank Weighted Rejected         │ nan      │   11.4811 │   9.4502   │  10.7107  │   1.6977   │   5.8394  │   3.885   │   4.8214    │   4.3434  │   3.8297  │   3.8208 │  10.4483  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤




│ 2/ Optimal RR (%)                   │ nan      │  nan      │  34        │  38.69    │   0.94     │   8.97    │   6.96    │   4.95      │   8.97    │   6.96    │   4.95   │  36.95    │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ 2/ Original RMSE ()                 │ nan      │  nan      │   1.4916   │   1.4916  │   1.4916   │   1.4916  │   1.4916  │   1.4916    │   1.4916  │   1.4916  │   1.4916 │   1.4916  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ 2/ Minimum RMSE                     │ nan      │  nan      │   1.4789   │   1.481   │   1.4882   │   1.3718  │   1.4005  │   1.4074    │   1.3925  │   1.4076  │   1.4384 │   1.2857  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ 2/ Change of RMSE (%)               │ nan      │  nan      │  -0.850296 │  -0.71088 │  -0.230177 │  -8.03252 │  -6.10605 │  -5.64647   │  -6.64125 │  -5.63103 │  -3.5694 │ -13.8071  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ 2/ Improvement of RMSE (%)          │ nan      │  nan      │   0.850296 │   0.71088 │   0.230177 │   8.03252 │   6.10605 │   5.64647   │   6.64125 │   5.63103 │   3.5694 │  13.8071  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ 2/ Mistake from Perfect             │ nan      │  nan      │ -18.9066   │ -19.4335  │ -19.2852   │ -18.0166  │ -19.1406  │ -20.0982    │ -18.4478  │ -19.4227  │ -20.9945 │ -13.7237  │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ 3/ Optimal Amount of times Rejected │ nan      │  nan      │ nan        │ nan       │ nan        │   0       │   0.0625  │   0.0212766 │   0       │   0.0625  │   0      │   2.10635 │
├─────────────────────────────────────┼──────────┼───────────┼────────────┼───────────┼────────────┼───────────┼───────────┼─────────────┼───────────┼───────────┼──────────┼───────────┤
│ 3/ Count of this Optimal            │ nan      │  nan      │ nan        │ nan       │ nan        │ 684       │   1       │   2         │ 685       │   1       │ 712      │   1       │
╰─────────────────────────────────────┴──────────┴───────────┴────────────┴───────────┴────────────┴───────────┴───────────┴─────────────┴───────────┴───────────┴──────────┴───────────╯