CHAPTER 1: INTRODUCTION
# This section introduces the purpose and background of the analysis.

In this analysis, we aim to evaluate the performance of different reject options for Information Treatment Effect (ITE) models.The ITE model predicts the individual treatment effects in a given dataset, providing valuable insights into the impact of interventions.
For your information, this file has been automatically generated on: 2024-03-02 18:09
\Chapter 2: Preprocessing

# This section executes the data retrieval, preprocessing and splitting in a training and dataset.During the whole file, the used dataset is: IHDP


CHAPTER 7: REJECTION 

# This section executes and reports metrics for ITE models with rejection.
CHAPTER 3: Training of the ITE Model

# This section provides details about the model selection, training process, and any hyperparameter tuning.
The trained ITE model is a T-LEARNER.
The two individually trained models are: LinearRegression


CHAPTER 7: REJECTION 

# This section executes and reports metrics for ITE models with rejection.


Table of all_data (First 5 rows)
+-----------+-------------------+--------------------+--------------------+--------------------+------------------+---------------------+----------+---------------+--------------+-------------+--------------------+--------------------+-----+----------+--------------------------+------------------------------+
| treatment |     y_t1_pred     |     y_t0_pred      |      ite_pred      |        y_t0        |       y_t1       |         ite         | category | category_pred | category_rej | ite_mistake |     ite_reject     |         se         | ood | y_reject | amount_of_times_rejected | amount_of_times_rejected_new |
+-----------+-------------------+--------------------+--------------------+--------------------+------------------+---------------------+----------+---------------+--------------+-------------+--------------------+--------------------+-----+----------+--------------------------+------------------------------+
|    nan    | 7.193863714802825 | 3.145412683434496  | 4.048451031368329  |  5.27630515157302  | 4.29383626530163 | -0.9824688862713895 |   nan    |      nan      |     nan      |     nan     | 4.048451031368329  | 25.310155217704036 |  1  |  False   |            0             |              0               |
|    0.0    | 4.924233534995176 | 2.5385879271199463 |  2.38564560787523  |  0.37146047771323  | 7.77452599653371 |  7.403065518820481  |   nan    |      nan      |     nan      |     nan     |  2.38564560787523  | 25.174502562749844 |  1  |  False   |            0             |              0               |
|    nan    | 5.309711124614462 | 1.715798218753361  | 3.5939129058611012 | -0.568745297078949 | 7.94687677112342 |  8.515622068202369  |   nan    |      nan      |     nan      |     nan     | 3.5939129058611012 | 24.22322107867398  |  1  |  False   |            0             |              0               |
|    nan    | 4.522012224992153 | 2.7281500401868897 | 1.7938621848052634 |  1.50519829739236  | 7.72702960004262 |  6.22183130265026   |   nan    |      nan      |     nan      |     nan     | 1.7938621848052634 |  19.606910508589   |  1  |  False   |            0             |              0               |
|    0.0    | 6.894930888844074 | 4.1417150221382295 | 2.753215866705845  |  2.72920854936937  | 9.49449669072071 |  6.765288141351341  |   nan    |      nan      |     nan      |     nan     | 2.753215866705845  | 16.09672393697909  |  1  |  False   |            0             |              0               |
+-----------+-------------------+--------------------+--------------------+--------------------+------------------+---------------------+----------+---------------+--------------+-------------+--------------------+--------------------+-----+----------+--------------------------+------------------------------+
# Experiment 0: No Rejector - Baseline Model
# Experiment 1: Perfect Rejection
# Experiment 2: Rejection based on IsolationForest (train data) - Novelty Type I
# Experiment 3: Rejection based on OneClassSVM (train data) - Novelty Type I
# Experiment 4: Rejection based on LocalOutlierFactor (train data) - Novelty Type I
# Experiment 5: Rejection based on IsolationForest (train data) - Novelty Type II
# Experiment 6: Rejection based on OneClassSVM (train data) - Novelty Type II
# Experiment 7: Rejection based on LocalOutlierFactor (train data) - Novelty Type II
# Experiment 8: Rejection based on IsolationForest (train data) - Novelty Type III
# Experiment 9: Rejection based on OneClassSVM (train data) - Novelty Type III
# Experiment 10: Rejection based on LocalOutlierFactor (train data) - Novelty Type III

# Experiment 11: (manual) Rejection based on IsolationForest - Novelty II
# Experiment 12: (manual) Rejection based on OSCVM - Novelty II
# Experiment 13: (manual) Rejection based on LocalOutlierFactor - Novelty II
# Experiment 14: (manual) Rejection based on IsolationForest - Novelty III

# Experiment 15: No Rejector - Baseline Model
# Experiment 16: Rejection based on IsolationForest (all data) - Novelty Type I
# Experiment 17: Rejection based on OneClassSVM (all data) - Novelty Type I
# Experiment 18: Rejection based on LocalOutlierFactor (all data) - Novelty Type I
# Experiment 19: Rejection based on IsolationForest (all data) - Novelty Type II
# Experiment 20: Rejection based on OneClassSVM (all data) - Novelty Type II
# Experiment 21: Rejection based on LocalOutlierFactor (all data) - Novelty Type II
# Experiment 22: Rejection based on IsolationForest (all data) - Novelty Type III
# Experiment 23: Rejection based on OneClassSVM (all data) - Novelty Type III
# Experiment 24: Rejection based on LocalOutlierFactor (all data) - Novelty Type III

# Experiment 25: No Rejector - Baseline Model
# Experiment 26: Rejection based on IsolationForest - Novelty Type I
# Experiment 27: Rejection based on OneClassSVM - Novelty Type I
# Experiment 28: Rejection based on LocalOutlierFactor - Novelty Type I
# Experiment 29: Rejection based on IsolationForest - Novelty Type II
# Experiment 30: Rejection based on OneClassSVM - Novelty Type II
# Experiment 31: Rejection based on LocalOutlierFactor - Novelty Type II
# Experiment 32: Rejection based on IsolationForest - Novelty Type III
# Experiment 33: Rejection based on OneClassSVM - Novelty Type III
# Experiment 34: Rejection based on LocalOutlierFactor - Novelty Type III

Table of results of the experiments
╭────────────────────────────┬──────────┬──────────┬────────────┬───────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬───────────┬───────────┬───────────┬───────────┬───────────┬───────────┬──────────┬────────────┬───────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────┬──────────╮
│                            │        0 │        1 │          2 │         3 │        4 │        5 │        6 │        7 │        8 │        9 │       10 │       11 │       12 │       13 │       14 │       15 │       16 │       17 │       18 │        19 │        20 │        21 │        22 │        23 │        24 │       25 │         26 │        27 │       28 │       29 │       30 │       31 │       32 │       33 │       34 │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ Rejection Rate             │   0      │   0.1392 │  0.0107    │  0.0683   │  0.0067  │  0.0897  │  0.079   │  0.0589  │  0.0897  │  0.0696  │  0.0589  │  0.0897  │  0.079   │  0.0589  │  0.0897  │   0.1392 │  0.0803  │  0.1124  │  0.1245  │  0.0375   │  0.0375   │  0.0589   │  0.0495   │  0.0696   │  0.0187   │   0.1392 │  0.0107    │  0.0683   │  0.0067  │  0.0897  │  0.079   │  0.0589  │  0.0897  │  0.0696  │  0.0589  │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ Original RMSE              │   1.4916 │   1.4916 │  1.4916    │  1.4916   │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │   1.4916 │  1.4815  │  1.4815  │  1.4815  │  1.4815   │  1.4815   │  1.4815   │  1.4815   │  1.4815   │  1.4815   │   1.4916 │  1.4916    │  1.4916   │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ RMSE                       │   1.4916 │   1.1013 │  1.4912    │  1.4834   │  1.4929  │  1.3718  │  1.384   │  1.4002  │  1.3925  │  1.404   │  1.4171  │  1.3718  │  1.384   │  1.4002  │  1.3925  │   1.1013 │  1.4525  │  1.4432  │  1.4635  │  1.4779   │  1.4727   │  1.4835   │  1.4778   │  1.474    │  1.4856   │   1.1013 │  1.4912    │  1.4834   │  1.4929  │  1.3718  │  1.384   │  1.4002  │  1.3925  │  1.404   │  1.4171  │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ Change of RMSE (%)         │   0      │ -26.1645 │ -0.0278    │ -0.5497   │  0.0865  │ -8.0338  │ -7.2146  │ -6.1268  │ -6.6426  │ -5.8716  │ -4.9965  │ -8.0338  │ -7.2146  │ -6.1268  │ -6.6426  │ -26.1645 │ -1.9537  │ -2.5856  │ -1.2099  │ -0.2374   │ -0.5901   │  0.1354   │ -0.2472   │ -0.5041   │  0.2799   │ -26.1645 │ -0.0278    │ -0.5497   │  0.0865  │ -8.0338  │ -7.2146  │ -6.1268  │ -6.6426  │ -5.8716  │ -4.9965  │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ RMSE Rejected              │ nan      │   2.9123 │  1.5295    │  1.5993   │  1.2858  │  2.389   │  2.4153  │  2.5392  │  2.2639  │  2.3695  │  2.3851  │  2.389   │  2.4153  │  2.5392  │  2.2639  │   2.9123 │  1.7796  │  1.7547  │  1.6019  │  1.5691   │  1.6905   │  1.449    │  1.5501   │  1.5779   │  1.2452   │   2.9123 │  1.5295    │  1.5993   │  1.2858  │  2.389   │  2.4153  │  2.5392  │  2.2639  │  2.3695  │  2.3851  │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ Accuracy                   │   0      │   0      │  0         │  0        │  0       │  0       │  0       │  0       │  0       │  0       │  0       │  0       │  0       │  0       │  0       │   0      │  0       │  0       │  0       │  0        │  0        │  0        │  0        │  0        │  0        │   0      │  0         │  0        │  0       │  0       │  0       │  0       │  0       │  0       │  0       │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ 2/ Optimal RR (%)          │ nan      │ nan      │  1.07      │  6.83     │  0.67    │  8.97    │  7.9     │  5.89    │  8.97    │  6.96    │  5.89    │  8.97    │  7.9     │  5.89    │  8.97    │ nan      │  8.03    │ 11.24    │ 12.45    │  3.88     │  3.88     │  5.89     │  4.95     │  6.96     │  1.87     │ nan      │  1.07      │  6.83     │  0.67    │  8.97    │  7.9     │  5.89    │  8.97    │  6.96    │  5.89    │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ 2/ Original RMSE ()        │ nan      │ nan      │  1.4916    │  1.4916   │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │ nan      │  1.4815  │  1.4815  │  1.4815  │  1.4815   │  1.4815   │  1.4815   │  1.4815   │  1.4815   │  1.4815   │ nan      │  1.4916    │  1.4916   │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │  1.4916  │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ 2/ Minimum RMSE            │ nan      │ nan      │  1.4912    │  1.4834   │  1.4929  │  1.3718  │  1.384   │  1.4002  │  1.3925  │  1.404   │  1.4171  │  1.3718  │  1.384   │  1.4002  │  1.3925  │ nan      │  1.4525  │  1.4432  │  1.4635  │  1.477    │  1.4736   │  1.4835   │  1.4778   │  1.474    │  1.4856   │ nan      │  1.4912    │  1.4834   │  1.4929  │  1.3718  │  1.384   │  1.4002  │  1.3925  │  1.404   │  1.4171  │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ 2/ Change of RMSE (%)      │ nan      │ nan      │ -0.0264031 │ -0.548243 │  0.08794 │ -8.03252 │ -7.21327 │ -6.12549 │ -6.64125 │ -5.87024 │ -4.99519 │ -8.03252 │ -7.21327 │ -6.12549 │ -6.64125 │ nan      │ -1.95611 │ -2.58796 │ -1.21226 │ -0.304043 │ -0.534889 │  0.132955 │ -0.249595 │ -0.506492 │  0.277445 │ nan      │ -0.0264031 │ -0.548243 │  0.08794 │ -8.03252 │ -7.21327 │ -6.12549 │ -6.64125 │ -5.87024 │ -4.99519 │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ 2/ Improvement of RMSE (%) │ nan      │ nan      │  0.0264031 │  0.548243 │ -0.08794 │  8.03252 │  7.21327 │  6.12549 │  6.64125 │  5.87024 │  4.99519 │  8.03252 │  7.21327 │  6.12549 │  6.64125 │ nan      │  1.95611 │  2.58796 │  1.21226 │  0.304043 │  0.534889 │ -0.132955 │  0.249595 │  0.506492 │ -0.277445 │ nan      │  0.0264031 │  0.548243 │ -0.08794 │  8.03252 │  7.21327 │  6.12549 │  6.64125 │  5.87024 │  4.99519 │
├────────────────────────────┼──────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼───────────┼───────────┼───────────┼───────────┼───────────┼───────────┼──────────┼────────────┼───────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ 2/ Mistake from Perfect    │ nan      │ nan      │ -3.4381    │ -3.4624   │ -3.5406  │ -2.2795  │ -2.3982  │ -2.5327  │ -2.4347  │ -2.5595  │ -2.7284  │ -2.2795  │ -2.3982  │ -2.5327  │ -2.4347  │ nan      │ -3.009   │ -2.8983  │ -3.0738  │ -3.246    │ -3.1992   │ -3.4011   │ -3.2701   │ -3.2303   │ -3.3986   │ nan      │ -3.4381    │ -3.4624   │ -3.5406  │ -2.2795  │ -2.3982  │ -2.5327  │ -2.4347  │ -2.5595  │ -2.7284  │
╰────────────────────────────┴──────────┴──────────┴────────────┴───────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴──────────┴────────────┴───────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────╯